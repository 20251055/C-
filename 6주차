#include <stdio.h>
#include <string.h>

#define N 5
#define NAME_MAX 64

int main(void){
    int i, choice, sub, id, q;
    int stock[N] = {0}, sold[N] = {0};
    char names[N][NAME_MAX];

    for(i = 0; i < N; i++)
        strcpy(names[i], "xxx");

    printf("[쇼핑몰 관리 프로그램]\n");

    while (1){
        printf("\n원하는 메뉴를 선택하세요.(1. 입고, 2. 판매, 3. 상품현황, 4. 상품명 입력, 5. 종료)\n> ");
        scanf("%d", &choice);

        if (choice == 1){
            printf("(출력)입고수량 입력 : 전체 상품 입고수량 입력 1, 개별 상품 입력 2 선택\n> ");
            scanf("%d", &sub);

            if (sub == 1){
                printf("(입력) ");
                for(i = 0; i < N; i++){
                    scanf("%d", &q);
                    if(q < 0) q = 0;
                    stock[i] += q;
                }
            }
            else if (sub == 2){
                printf("(입력)상품ID : ");
                scanf("%d", &id);
                printf("(입력)입고수량 : ");
                scanf("%d", &q);
                if (id >= 1 && id <= N){
                    if (q < 0) q = 0;
                    stock[id - 1] += q;
                }
            }
        }

        else if (choice == 2){
            printf("(출력)판매수량 입력 : 전체 상품 판매수량 입력 1, 개별 상품 입력 2 선택\n> ");
            scanf("%d", &sub);

            if (sub == 1){
                printf("(입력) ");
                for(i = 0; i < N; i++){
                    scanf("%d", &q);
                    if(q < 0) q = 0;
                    if(q > stock[i]) q = stock[i];
                    sold[i] += q;
                    stock[i] -= q;
                }
            }
            else if (sub == 2){
                printf("(입력)상품ID : ");
                scanf("%d", &id);
                printf("(입력)판매수량 : ");
                scanf("%d", &q);
                if(id >= 1 && id <= N){
                    if(q < 0) q = 0;
                    if(q > stock[id - 1]) q = stock[id - 1];
                    sold[id - 1] += q;
                    stock[id - 1] -= q;
                }
            }
        }

        else if (choice == 3){
            int totalSold = 0, totalStock = 0;
            int max_id = 1, min_id = 1;
            int max_s = sold[0], min_s = sold[0];

            printf("재고수량 : ");
            for(i = 0; i < N; i++){
                printf("%d", stock[i]);
                if(i < N - 1) printf(" ");
                totalSold += sold[i];
                totalStock += stock[i];

                if(sold[i] > max_s){
                    max_s = sold[i];
                    max_id = i + 1;
                }
                if(sold[i] < min_s){
                    min_s = sold[i];
                    min_id = i + 1;
                }
            }
            printf("\n");

            double rate = (totalSold + totalStock == 0) ? 0 : (double)totalSold / (totalSold + totalStock) * 100;
            printf("총 판매량 : %d (판매율 %.2f%%)\n", totalSold, rate);

            printf("가장 많이 판매된 상품 : ID %d, 상품명 %s, 판매량 %d\n",
                   max_id, names[max_id - 1], max_s);
            printf("가장 적게 판매된 상품 : ID %d, 상품명 %s, 판매량 %d\n",
                   min_id, names[min_id - 1], min_s);

            for(i = 0; i < N; i++){
                if(stock[i] <= 2){
                    printf("상품 ID %d : 재고부족(%d)\n", i+1, stock[i]);
                }
            }
        }

        else if (choice == 4){
            int c;
            while((c = getchar()) != '\n' && c != EOF);

            for(i = 0; i < N; i++){
                printf("(출력) ID %d 상품명 : (입력)", i+1);
                fgets(names[i], NAME_MAX, stdin);

                int len = strlen(names[i]);
                if(len > 0 && names[i][len-1] == '\n')
                    names[i][len-1] = '\0';

                if(names[i][0] == '\0')
                    strcpy(names[i], "xxx");
            }
        }

        else if (choice == 5){
            printf("프로그램 종료\n");
            break;
        }
    }

    return 0;
}
